Asset Class Trend Following 策略重現指南
1. 策略邏輯說明
本策略參考 QuantConnect Strategy 17 "Asset Class Trend Following"。

資產池: 122 檔標的。

指標: 簡單移動平均線 (SMA) 與 變動率 (ROC)。

進場條件: 當價格高於 SMA 時，視為上升趨勢。

排名依據: 在所有符合進場條件的標的中，依據 ROC (動能) 由高到低排名。

持股數量: 最多持有 3 檔。

權重分配: 等權重分配 (1/N)。

再平衡週期: 每 5 個交易日。

交易執行: T 日產生訊號，T+1 日以收盤價執行交易。

投入資金: 每次單筆金額為 3000 萬元，平均分配給前 3 大持股。

2. 資料整理規則
未上市標的: 若 Excel 檔內的 122 檔股票初始值為空欄，表示該期間該標的尚未上市，則以第一次出現的價格作為填補。

暫停交易標的: 若交易期間有中斷價格，表示暫停交易，則以前一日的收盤價作為填補。

3. 進出場邏輯
每 5 天平衡一次，以 產生訊號日的下一交易日收盤價 作為進出場價格。

當期新產出的應買進前 3 大持股。

若有與前期相同的持股，則以前次持股股數繼續持倉，避免過度進出浪費交易成本。

僅剔除不再符合條件的標的，並新增新的標的。

4. 計算公式
SMA (Simple Moving Average):

𝑆
𝑀
𝐴
𝑛
=
1
𝑛
∑
𝑖
=
0
𝑛
−
1
𝑃
𝑡
−
𝑖
ROC (Rate of Change):

𝑅
𝑂
𝐶
𝑛
=
𝑃
𝑡
−
𝑃
𝑡
−
𝑛
𝑃
𝑡
−
𝑛
CAGR (Compound Annual Growth Rate):

(
𝐹
𝑖
𝑛
𝑎
𝑙
 
𝐸
𝑞
𝑢
𝑖
𝑡
𝑦
𝐼
𝑛
𝑖
𝑡
𝑖
𝑎
𝑙
 
𝐸
𝑞
𝑢
𝑖
𝑡
𝑦
)
365.25
/
𝐷
𝑎
𝑦
𝑠
−
1
Max Drawdown:

min
⁡
(
𝐸
𝑞
𝑢
𝑖
𝑡
𝑦
−
𝑃
𝑒
𝑎
𝑘
𝑃
𝑒
𝑎
𝑘
)
Calmar Ratio:

𝐶
𝐴
𝐺
𝑅
∣
𝑀
𝑎
𝑥
𝐷
𝐷
∣
5. 最佳化結果
最佳 SMA 參數: 50

CAGR: 114.50%

MaxDD: -38.35%

Calmar Ratio: 2.99

6. 參數高原 (部分)
SMA	CAGR	MaxDD	Calmar
10	86.32%	-52.66%	1.64
20	86.20%	-57.91%	1.49
30	111.47%	-39.00%	2.86
40	104.69%	-38.92%	2.69
50	114.50%	-38.35%	2.99
60	99.80%	-44.02%	2.27
70	100.75%	-43.64%	2.31
80	122.39%	-42.05%	2.91
90	109.04%	-40.93%	2.66
100	120.00%	-41.65%	2.88
(完整高原表請詳見 Excel 檔案中的 Plateau_Table 分頁)

7. 實作說明 (IPYNB 檔案)
檔案結構:

區塊化程式碼，包含資料讀取、資料清理、策略邏輯、回測模組、績效分析。

每個區塊皆附上繁體中文說明，方便理解與教學。

參數管理:

所有參數值 (如 SMA 週期、再平衡週期、持股數量、投入資金等) 集中放在同一區域，方便檢視或後續調整。

回測輸出:

績效指標 (CAGR、MaxDD、Calmar Ratio)。

資產淨值曲線。

持股紀錄與交易明細。